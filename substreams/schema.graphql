type Token @entity(immutable: false) {
    id: ID!
    name: String!
    symbol: String!
    decimals: BigInt!
    totalSupply: BigInt!
    tokenDeployment: TokenDeployment @derivedFrom(field: "token")
    tokenTransfers: [TokenTransfer!] @derivedFrom(field: "token")
    tokenHolders: [TokenHolder!] @derivedFrom(field: "token")
}

type TokenDeployment @entity(immutable: false) {
    id: ID!
    blocknumber: BigInt!
    timestamp: BigInt!
    # txHash: String
    token: Token 
}

type TokenTransfer @entity(immutable: true) {
    id: ID!
    from: String!
    to: String!
    amount: BigInt!
    count: BigInt!
    volume: BigInt!
    token: Token
    blocknumber: BigInt!
    timestamp: BigInt!
    tokenHolderTo: TokenHolder
    tokenHolderFrom: TokenHolder
}

type TokenHolder @entity(immutable: false) {
    id: ID!
    holderAddress: String!
    tokenHolderSnapshots: [TokenHolderSnapshot!] @derivedFrom(field: "tokenHolder")
    transfersTo: [TokenTransfer!] @derivedFrom(field: "tokenHolderTo")
    transfersFrom: [TokenTransfer!] @derivedFrom(field: "tokenHolderFrom")
    token: Token
    timestamp: BigInt!
}

type TokenHolderSnapshot @entity(immutable: false) {
    id: ID!
    tokenHolder: TokenHolder
    balance: BigInt!
    transferVolume: BigInt!
    transferCount: BigInt!
    timestamp: BigInt!
    monthId: BigInt!
}


